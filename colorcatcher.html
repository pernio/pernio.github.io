<!--THIS IS A PRACTICE PROJECT FOR EXAMS OF WEBDESIGN ESSENTIALS. HTML AND CSS IS WRITTEN BY ME, THE AUTHOR. 
    SCRIPTING IS GENERATED BY CHATGPT 3.5. ONLY HTML AND CSS WAS PRACTICED HERE. NOT SCRIPTING.
    THIS WAS ONLY GENERATED AND IMPLEMENTED BY INTENTION TO MAKE THE SYSTEM OF THE GAME WORK.-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Color catcher</title>
    <meta property="og:title" content="Color catcher!">
    <meta property="og:description" content="Catch the correct color by playing with rgb values!">
    <meta property="og:image" content="images/logo.svg">
    <meta name="theme-color" content="#75d68e">
    <link rel="icon" href="images/logo.svg">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/colorcatcher.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>

<body>
    <header>
        <a href="index.html" id="home"><i class="fa-solid fa-house fa-2xl"></i></a>
        <h1>Color catcher!</h1>
    </header>
    <div id="container">
        <p id="colorMatch">Color Match: 0%</p>
        <div id="img1"></div>
        <div id="img2"></div>
        <div id="slidecontainer">
            <p>Red: <span id="valueRed"></span></p>
            <input type="range" min="0" max="255" value="128" class="slider" id="rangeRed">
            <p>Green: <span id="valueGreen"></span></p>
            <input type="range" min="0" max="255" value="128" class="slider" id="rangeGreen">
            <p>Blue: <span id="valueBlue"></span></p>
            <input type="range" min="0" max="255" value="128" class="slider" id="rangeBlue">
        </div>
    </div>
    <footer>
        <p id="endHex">Guessed Hex: <span id="hexValue"></span></p>
        <p id="timer">Time: <span id="timerValue">0</span></p>
        <a href="#" onclick="window.location.reload();">Play again</a>
    </footer>
    <script>
        // SCRIPTING CODE GENERATED BY CHATGPT 3.5
        var sliderRed = document.getElementById("rangeRed");
        var outputRed = document.getElementById("valueRed");
        var sliderGreen = document.getElementById("rangeGreen");
        var outputGreen = document.getElementById("valueGreen");
        var sliderBlue = document.getElementById("rangeBlue");
        var outputBlue = document.getElementById("valueBlue");
        var img1 = document.getElementById('img1');
        var img2 = document.getElementById('img2');
        var colorMatch = document.getElementById('colorMatch');
        var container = document.getElementById("container");
        var endHex = document.getElementById("endHex");
        var hexValue = document.getElementById("hexValue");
        var timerValue = document.getElementById('timerValue');
        var timerContainer = document.getElementById('timer');
        var timerInterval;
        var seconds = 0;
        var body = document.body;

        outputRed.innerHTML = sliderRed.value;
        outputGreen.innerHTML = sliderGreen.value;
        outputBlue.innerHTML = sliderBlue.value;

        sliderRed.oninput = function() {
            outputRed.innerHTML = this.value;
            updateColor();
        }

        sliderGreen.oninput = function() {
            outputGreen.innerHTML = this.value;
            updateColor();
        }

        sliderBlue.oninput = function() {
            outputBlue.innerHTML = this.value;
            updateColor();
        }

        // Function to start the timer
        function startTimer() {
            timerInterval = setInterval(function() {
                seconds++;
                timerValue.textContent = seconds;
            }, 1000);
        }

        // Function to stop the timer
        function stopTimer() {
            clearInterval(timerInterval);
        }

        // Function to update the color of #img1
        function updateColor() {
            var rgb = sliderRed.value + ', ' + sliderGreen.value + ', ' + sliderBlue.value;
            var hex = rgbToHex(sliderRed.value, sliderGreen.value, sliderBlue.value);
            img1.style.backgroundColor = 'rgb(' + rgb + ')';

            // Calculate color match percentage
            var diffPercentage = calculateColorMatch();
            colorMatch.textContent = 'Color Match: ' + diffPercentage + '%';

            // Check if the color match is 100%
            if (diffPercentage >= 100) {
                stopTimer(); // Stop the timer on 100% match
                triggerTransformation(hex);
            }
        }

        // Function to calculate color match percentage
        function calculateColorMatch() {
            var color1 = getComputedStyle(img1).backgroundColor.match(/\d+/g);
            var color2 = getComputedStyle(img2).backgroundColor.match(/\d+/g);
            var diff = 0;

            for (var i = 0; i < color1.length; i++) {
                diff += Math.abs(parseInt(color1[i]) - parseInt(color2[i]));
            }

            var maxMatch = 255 * 3; // Maximum possible match for RGB values
            var diffPercentage = ((1 - diff / maxMatch) * 100).toFixed(0);

            // Round to the nearest 10%
            diffPercentage = Math.trunc(diffPercentage);

            return diffPercentage;
        }

        // Function to convert RGB to hex
        function componentToHex(c) {
            var hex = c.toString(16);
            return hex.length == 1 ? "0" + hex : hex;
        }

        function rgbToHex(r, g, b) {
            return "#" + componentToHex(parseInt(r)) + componentToHex(parseInt(g)) + componentToHex(parseInt(b));
        }

        // Function to trigger the transform
        function triggerTransformation(hex) {
            body.style.transition = 'background-color 2s ease-in-out';
            body.style.backgroundColor = hex;

            // Disable input during transformation
            var inputs = document.querySelectorAll('input');
            inputs.forEach(function(input) {
                input.disabled = true;
            });

            // Hide other objects
            container.style.display = 'none';

            // Display the hex code and timer value
            endHex.innerHTML = 'Guessed Hex: <span>' + hex + '</span><br>Time taken: ' + seconds + ' seconds';

            // Display the endHex element
            endHex.style.display = 'block';
            document.querySelector('header').style.marginBottom = '0';
            document.querySelector('footer').style.marginTop = '0';
            timerContainer.style.display = 'none';

            // Handle layout based on screen width
            handleGameEndLayout();
        }

        // Function to handle layout based on screen width
        function handleGameEndLayout() {
            var screenWidth = window.innerWidth;

            if (screenWidth <= 365) {
                document.querySelector('header h1').style.display = 'none';
                document.querySelector('footer').style.paddingTop = '20px';
                document.querySelector('footer').style.borderRadius = '20px';
                endHex.style.paddingTop = '0';
            } else {
                document.querySelector('header h1').style.display = 'block';
                document.querySelector('footer').style.paddingTop = '0';
                document.querySelector('footer').style.borderTopLeftRadius = '0';
                document.querySelector('footer').style.borderTopRightRadius = '0';
                document.querySelector('footer').style.borderBottomLeftRadius = '20px';
                document.querySelector('footer').style.borderBottomRightRadius = '20px';
                endHex.style.paddingTop = '15px';
            }
        }

        // Event listener for window resize
        window.addEventListener('resize', handleGameEndLayout);

        // Event listener for touch events
        container.addEventListener('touchstart', function(e) {
            startY = e.touches[0].clientY;
        });

        container.addEventListener('touchmove', function(e) {
            var deltaY = e.touches[0].clientY - startY;

            if (Math.abs(deltaY) > Math.abs(e.touches[0].clientX - e.touches[1].clientX)) {
                e.preventDefault();
            }
        });

        // Function to generate a random RGB color
        function getRandomColor() {
            return 'rgb(' +
                Math.floor(Math.random() * 256) + ',' +
                Math.floor(Math.random() * 256) + ',' +
                Math.floor(Math.random() * 256) + ')';
        }

        // Apply a random color to #img2 and update the color
        img2.style.backgroundColor = getRandomColor();
        updateColor();

        // Start the timer when the script runs
        startTimer();

    </script>
</body>

</html>
